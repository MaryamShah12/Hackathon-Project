<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Farmer Dashboard â€“ Harvest Hub</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://unpkg.com/lucide@latest/font/lucide.css">

  <!-- Design-System -->
  <link rel="stylesheet" href="style.css">

  <style>
    /* ----- farmer-specific tweaks ----- */
    .welcome-banner{
      background:linear-gradient(135deg,var(--fresh-green) 0%,#66bb6a 100%);
      color:#fff;border-radius:var(--radius);padding:24px;margin-bottom:32px;
      display:flex;align-items:center;gap:16px;box-shadow:var(--shadow-md)
    }
    .welcome-banner i{width:48px;height:48px;opacity:.9}
    .tab-container{margin-bottom:24px}
    .listing-item{
      background:#fff;border-radius:var(--radius);padding:20px;
      box-shadow:var(--shadow-sm);margin-bottom:16px;display:flex;justify-content:space-between;align-items:center;transition:transform .3s
    }
    .listing-item:hover{transform:translateY(-2px);box-shadow:var(--shadow-md)}
    .listing-info h3{font-size:1.1rem;margin-bottom:6px}
    .listing-info p{font-size:.875rem;color:var(--muted);margin:2px 0}
    .actions{display:flex;gap:8px}
  </style>
</head>

<body>
<!-- ========== NAVBAR (consistent) ========== -->
<nav class="navbar">
  <div class="nav-container">
    <a href="index.html" class="logo">
      <i data-lucide="sprout"></i> Harvest Hub
    </a>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="farmer.html" class="active">Dashboard</a></li>
      <li><a href="farmer_analytics.html">Analytics</a></li>
      <li><a id="logoutBtn"><i data-lucide="log-out"></i></a></li>
      <li><a href="purchase_requests.html">Purchase Requests</a></li>
    </ul>
  </div>
</nav>

<!-- ========== DASHBOARD ========== -->
<section class="dashboard-section">
  <div class="dashboard-container">
    <div class="welcome-banner">
      <i data-lucide="user"></i>
      <div>
        <h2>Welcome, <span id="welcomeName"></span>!</h2>
        <p>Add your surplus crops and manage your listings.</p>
      </div>
    </div>

    <!-- ADD LISTING FORM -->
    <form id="listingForm" class="listing-form">
      <input id="cropName" type="text" placeholder="Crop Name" required>
      <input id="cropQuantity" type="text" placeholder="Quantity (e.g., 10 kg)" required>

      <select id="listingType" required>
        <option value="">Select Type</option>
        <option value="sell">Sell (Fair Price)</option>
        <option value="barter">Barter</option>
        <option value="donate">Donate</option>
      </select>

      <input id="availableDate" type="date" required>
      <input id="price" type="number" step="0.01" placeholder="Price (auto for sell)">

      <div id="fairPriceSection" style="display:none;grid-column:span 2">
        <input id="wholesalePrice" type="number" step="0.01" placeholder="Wholesale Price">
        <input id="retailPrice" type="number" step="0.01" placeholder="Retail Price">
      </div>

      <button type="submit" class="btn">
        <i data-lucide="plus-circle"></i> Add Listing
      </button>
    </form>

    <!-- LISTINGS -->
    <h3>Your Crop Listings</h3>

    <div class="tab-container">
      <button class="tab-btn active" onclick="openTab(event,'sellTab')">Sell</button>
      <button class="tab-btn" onclick="openTab(event,'barterTab')">Barter</button>
      <button class="tab-btn" onclick="openTab(event,'donateTab')">Donations</button>
    </div>

    <div id="sellTab" class="tab-content active">
      <ul id="sellList"></ul>
    </div>
    <div id="barterTab" class="tab-content">
      <ul id="barterList"></ul>
    </div>
    <div id="donateTab" class="tab-content">
      <h4>Available Donations</h4>
      <ul id="availableDonateList"></ul>
      <h4>Claimed Donations</h4>
      <ul id="claimedDonateList"></ul>
    </div>
  </div>
</section>

<!-- ========== EDIT MODAL ========== -->
<div id="editModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2><i data-lucide="edit-3"></i> Edit Listing</h2>

    <form id="editForm" class="listing-form">
      <input type="hidden" id="editListingId">
      <input id="editCropName" type="text" placeholder="Crop Name" required>
      <input id="editCropQuantity" type="text" placeholder="Quantity" required>

      <select id="editListingType" required>
        <option value="">Select Type</option>
        <option value="sell">Sell (Fair Price)</option>
        <option value="barter">Barter</option>
        <option value="donate">Donate</option>
      </select>

      <input id="editAvailableDate" type="date" required>
      <input id="editPrice" type="number" step="0.01" placeholder="Price (auto for sell)">

      <div id="editFairPriceSection" style="display:none;grid-column:span 2">
        <input id="editWholesalePrice" type="number" step="0.01" placeholder="Wholesale Price">
        <input id="editRetailPrice" type="number" step="0.01" placeholder="Retail Price">
      </div>

      <button type="submit" class="btn">
        <i data-lucide="save"></i> Save Changes
      </button>
    </form>
  </div>
</div>

<!-- ========== SCRIPTS ========== -->
<script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
<script>
  lucide.createIcons();
  const role = "farmer";
</script>
<script src="dashboard.js"></script>
</body>
</html>